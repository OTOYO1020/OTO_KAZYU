{
    "id": "openstack%2Fglance~master~Ieca90f45e07cc3645a997bba493e0b9a9f08a470",
    "project": "openstack/glance",
    "branch": "master",
    "hashtags": [],
    "change_id": "Ieca90f45e07cc3645a997bba493e0b9a9f08a470",
    "subject": "Kill glance-api child workers on SIGINT",
    "status": "MERGED",
    "created": "2012-04-11 17:00:52.000000000",
    "updated": "2012-04-12 15:16:46.000000000",
    "submitted": "2012-04-12 15:16:45.000000000",
    "submitter": {
        "_account_id": 3,
        "name": "Jenkins",
        "username": "jenkins"
    },
    "insertions": 38,
    "deletions": 2,
    "total_comment_count": 5,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "d0c0899048c59036cfff1426046b4d1b3c856b1e",
    "_number": 6468,
    "owner": {
        "_account_id": 2284,
        "name": "Eoghan Glynn",
        "email": "eglynn@redhat.com",
        "username": "eglynn"
    },
    "labels": {
        "Verified": {
            "recommended": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 2284,
                    "name": "Eoghan Glynn",
                    "email": "eglynn@redhat.com",
                    "username": "eglynn"
                },
                {
                    "value": 0,
                    "_account_id": 679,
                    "name": "Kevin L. Mitchell",
                    "email": "klmitch@mit.edu",
                    "username": "klmitch"
                },
                {
                    "value": 0,
                    "_account_id": 7,
                    "name": "Jay Pipes",
                    "email": "jaypipes@gmail.com",
                    "username": "jaypipes"
                },
                {
                    "value": 0,
                    "_account_id": 2759,
                    "name": "Huang Zhiteng",
                    "email": "winston.d@gmail.com",
                    "username": "zhiteng-huang"
                },
                {
                    "value": 1,
                    "date": "2012-04-12 15:16:45.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "value": 1,
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "approved": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "all": [
                {
                    "value": 0,
                    "date": "2012-04-12 12:04:56.000000000",
                    "permitted_voting_range": {
                        "min": 0,
                        "max": 1
                    },
                    "_account_id": 2284,
                    "name": "Eoghan Glynn",
                    "email": "eglynn@redhat.com",
                    "username": "eglynn"
                },
                {
                    "value": 2,
                    "date": "2012-04-12 15:04:45.000000000",
                    "_account_id": 679,
                    "name": "Kevin L. Mitchell",
                    "email": "klmitch@mit.edu",
                    "username": "klmitch"
                },
                {
                    "value": 2,
                    "date": "2012-04-12 14:24:32.000000000",
                    "_account_id": 7,
                    "name": "Jay Pipes",
                    "email": "jaypipes@gmail.com",
                    "username": "jaypipes"
                },
                {
                    "value": 0,
                    "_account_id": 2759,
                    "name": "Huang Zhiteng",
                    "email": "winston.d@gmail.com",
                    "username": "zhiteng-huang"
                },
                {
                    "value": 0,
                    "date": "2012-04-12 15:16:45.000000000",
                    "permitted_voting_range": {
                        "min": 0,
                        "max": 1
                    },
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "approved": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "all": [
                {
                    "value": 0,
                    "date": "2012-04-12 12:04:56.000000000",
                    "_account_id": 2284,
                    "name": "Eoghan Glynn",
                    "email": "eglynn@redhat.com",
                    "username": "eglynn"
                },
                {
                    "value": 1,
                    "date": "2012-04-12 15:04:53.000000000",
                    "_account_id": 679,
                    "name": "Kevin L. Mitchell",
                    "email": "klmitch@mit.edu",
                    "username": "klmitch"
                },
                {
                    "value": 0,
                    "date": "2012-04-12 14:24:32.000000000",
                    "_account_id": 7,
                    "name": "Jay Pipes",
                    "email": "jaypipes@gmail.com",
                    "username": "jaypipes"
                },
                {
                    "value": 0,
                    "_account_id": 2759,
                    "name": "Huang Zhiteng",
                    "email": "winston.d@gmail.com",
                    "username": "zhiteng-huang"
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "value": 0,
                    "_account_id": 2284,
                    "name": "Eoghan Glynn",
                    "email": "eglynn@redhat.com",
                    "username": "eglynn"
                },
                {
                    "value": 0,
                    "_account_id": 679,
                    "name": "Kevin L. Mitchell",
                    "email": "klmitch@mit.edu",
                    "username": "klmitch"
                },
                {
                    "value": 0,
                    "_account_id": 7,
                    "name": "Jay Pipes",
                    "email": "jaypipes@gmail.com",
                    "username": "jaypipes"
                },
                {
                    "value": 0,
                    "_account_id": 2759,
                    "name": "Huang Zhiteng",
                    "email": "winston.d@gmail.com",
                    "username": "zhiteng-huang"
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            {
                "_account_id": 2759,
                "name": "Huang Zhiteng",
                "email": "winston.d@gmail.com",
                "username": "zhiteng-huang"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2012-04-12 02:33:39.000000000",
            "updated_by": {
                "_account_id": 2759,
                "name": "Huang Zhiteng",
                "email": "winston.d@gmail.com",
                "username": "zhiteng-huang"
            },
            "reviewer": {
                "_account_id": 2759,
                "name": "Huang Zhiteng",
                "email": "winston.d@gmail.com",
                "username": "zhiteng-huang"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2012-04-12 14:24:32.000000000",
            "updated_by": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "reviewer": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2012-04-12 15:04:53.000000000",
            "updated_by": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "reviewer": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2012-04-12 15:16:45.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "9e33d2254307b67edb78bdf3809479d5e5c80af7",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-11 17:18:46.000000000",
            "message": "Patch Set 1: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "ab26adbe993e3d6a0692cac9de0e9515ac477e8d",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-11 17:22:55.000000000",
            "message": "Patch Set 1: (1 inline comment)\n\nThanks for the review Kevin, response inline.\n\nCheers,\nEoghan",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "014ef82c87e65c5f0536ac256ed1a95fe221a6ca",
            "author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "real_author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "date": "2012-04-11 17:27:45.000000000",
            "message": "Patch Set 1:\n\nSeems sensible -- though I think removing the sys.exit() call in the Server is necessary too.\n\nEoghan, I hate to be annoying, but is there a way we can test this fix? I know it's not the easiest thing to test... but you did a bang-up job with the glance-control testing :)\n\n-jay",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "bb91dd4faf26890ff6ccdc0914b4707dc045342e",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-11 17:28:35.000000000",
            "message": "Patch Set 1: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "0ae6ed105e9f806a10f564efcc86d85b5ba9d31d",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-11 20:29:37.000000000",
            "message": "Uploaded patch set 2.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "272108c93314037335ee5a67b73dd36d409cf56f",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-11 20:39:08.000000000",
            "message": "Patch Set 2:\n\nThanks for the review Jay.\n\nTest added in patch set 2 which fires SIGINT at all the glance-api processes (as would the terminal driver on ctrl+c) and then ensures that no new children are spawned.\n\nWithout the fix to wsgi.py, this test shows the storm of respawned children as reported in the bug.\n\nCheers,\nEoghan",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "dcb590892adfea02d9c019022cb15f5651df4e04",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-11 20:43:01.000000000",
            "message": "Uploaded patch set 3.",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "d3776316a6af05e51abf5e6045ae35f9b33eabdb",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-11 20:44:37.000000000",
            "message": "Patch Set 3:\n\nThanks for the further comment Kevin, response inline.\n\nCheers,\nEoghan",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "21036a85c92cabf69029acd2dd954eb95700343c",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-11 22:16:25.000000000",
            "message": "Patch Set 3: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "157ba4f4b724bb1074882c853f50dc060df943a5",
            "author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "real_author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "date": "2012-04-12 00:02:42.000000000",
            "message": "Patch Set 3: Looks good to me (core reviewer)\n\nVerified the test does show a failure on master and no failure with this patch to wsgi.py. Nice work, Eoghan.",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "c25617fc8b9a74ccac0af31735ad16ff87d7a593",
            "author": {
                "_account_id": 2759,
                "name": "Huang Zhiteng",
                "email": "winston.d@gmail.com",
                "username": "zhiteng-huang"
            },
            "real_author": {
                "_account_id": 2759,
                "name": "Huang Zhiteng",
                "email": "winston.d@gmail.com",
                "username": "zhiteng-huang"
            },
            "date": "2012-04-12 02:34:52.000000000",
            "message": "Patch Set 3: Looks good to me, but someone else must approve\n\nI agree with Jay that sys.exit() should be removed.  Other than that, looks good to me.",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "ddeb298bb2a9b67fe554abc0a798b666a288f437",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-12 11:54:46.000000000",
            "message": "Uploaded patch set 4.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "39d98d25437c92a34ea7eb671d53e50d9ca3a280",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-12 12:00:17.000000000",
            "message": "Uploaded patch set 5.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "8f1a72a53a78f305a8c02c0a1819af0cb6094348",
            "author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "real_author": {
                "_account_id": 2284,
                "name": "Eoghan Glynn",
                "email": "eglynn@redhat.com",
                "username": "eglynn"
            },
            "date": "2012-04-12 12:04:56.000000000",
            "message": "Patch Set 5:\n\nAgreed that the sys.exit() prior to a break is clearly out of place, however it wasn't germane to the current issue, so originally I was minded to leave it in place pending a further patch to remove. However in retrospect, its probably best just to be rid of it, which I've done in the latest patch set.\n\nI've also changed the child signal handling logic slightly, now ignoring interrupts to avoid a race condition whereby a child worker receives the SIGINT before the parent and is respawned unneccessarily as a result.\n\nThe downside is that a SIGINT sent to a child only (i.e. not to the parent also) will have no effect. However, I don't think this is a realistic use-case, as selectively killing children is likely to acheived via kill -TERM.\n\nAlso re-ordered imports as requested.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "07c7b58ec0a242c1b9f44dc9d9f645c5079ca112",
            "author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "real_author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "date": "2012-04-12 14:24:32.000000000",
            "message": "Patch Set 5: Looks good to me (core reviewer)\n\nNice work, Eoghan!",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "9a6bdaae7420425be75addca082d0483e78d09f5",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-12 14:40:36.000000000",
            "message": "Patch Set 5: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "e02b880de5644874adb572973f521a062cc28f70",
            "author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "real_author": {
                "_account_id": 7,
                "name": "Jay Pipes",
                "email": "jaypipes@gmail.com",
                "username": "jaypipes"
            },
            "date": "2012-04-12 14:41:32.000000000",
            "message": "Patch Set 5:\n\nKevin, not really... it's just a test anyway, so not really concerned...",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "a87ae3d4334714c1e8ff7d2974723d764f41ad4e",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-12 15:04:45.000000000",
            "message": "Patch Set 5: Looks good to me (core reviewer)\n\nYeah, I figured, but thought I'd double-check :)  OK, then\u2026",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "6ce864d99f758f29c087b65b5338b4dc99a1c128",
            "author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "real_author": {
                "_account_id": 679,
                "name": "Kevin L. Mitchell",
                "email": "klmitch@mit.edu",
                "username": "klmitch"
            },
            "date": "2012-04-12 15:04:53.000000000",
            "message": "Patch Set 5: Approved\n\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "4d21e0e27c3967dda837145125a0cd792197f5fe",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2012-04-12 15:16:45.000000000",
            "message": "Patch Set 5: Verified\n\nBuild Successful \n \nhttps://jenkins.openstack.org/job/gate-integration-tests-devstack-vm/3447/ : SUCCESS \nhttps://jenkins.openstack.org/job/gate-glance-merge/564/ : SUCCESS \nhttps://jenkins.openstack.org/job/gate-glance-pep8/744/ : SUCCESS \nhttps://jenkins.openstack.org/job/gate-glance-python26/257/ : SUCCESS \nhttps://jenkins.openstack.org/job/gate-glance-python27/249/ : SUCCESS",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "d0c0899048c59036cfff1426046b4d1b3c856b1e",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2012-04-12 15:16:46.000000000",
            "message": "Change has been successfully merged into the git repository.",
            "accounts_in_message": [],
            "_revision_number": 5
        }
    ],
    "requirements": [],
    "submit_records": []
}
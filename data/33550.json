{
    "id": "openstack%2Fglance~master~Ibb0968f40cc99f0177dc6909ae08767442030472",
    "project": "openstack/glance",
    "branch": "master",
    "topic": "bug/1191115",
    "hashtags": [],
    "change_id": "Ibb0968f40cc99f0177dc6909ae08767442030472",
    "subject": "Allows nova snapshot errors to be passed to glance",
    "status": "ABANDONED",
    "created": "2013-06-18 22:06:13.000000000",
    "updated": "2013-07-09 06:03:06.000000000",
    "insertions": 19,
    "deletions": 0,
    "total_comment_count": 1,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "dd43d0ad9ef09cd1fa0241cf7543a387466642c6",
    "_number": 33550,
    "owner": {
        "_account_id": 5313,
        "name": "David Peraza",
        "email": "david_peraza@persistentsys.com",
        "username": "dperaza"
    },
    "labels": {
        "Verified": {
            "recommended": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "all": [
                {
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 1,
                    "date": "2013-06-19 19:46:57.000000000",
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "_account_id": 5313,
                    "name": "David Peraza",
                    "email": "david_peraza@persistentsys.com",
                    "username": "dperaza"
                },
                {
                    "value": 1,
                    "date": "2013-06-19 20:15:37.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "value": 1,
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "disliked": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "all": [
                {
                    "value": -1,
                    "date": "2013-06-24 20:43:32.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": -1,
                    "date": "2013-06-29 16:02:34.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "date": "2013-06-26 21:35:25.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 5313,
                    "name": "David Peraza",
                    "email": "david_peraza@persistentsys.com",
                    "username": "dperaza"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "value": -1,
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "all": [
                {
                    "date": "2013-06-24 20:43:32.000000000",
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "date": "2013-06-29 16:02:34.000000000",
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 0
                    },
                    "_account_id": 5313,
                    "name": "David Peraza",
                    "email": "david_peraza@persistentsys.com",
                    "username": "dperaza"
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "_account_id": 5313,
                    "name": "David Peraza",
                    "email": "david_peraza@persistentsys.com",
                    "username": "dperaza"
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2013-06-19 19:46:57.000000000",
            "updated_by": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "reviewer": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-06-19 20:15:37.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-06-24 20:43:32.000000000",
            "updated_by": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "reviewer": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-06-29 16:02:34.000000000",
            "updated_by": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "reviewer": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "9a4763b25b96f657f4b9d919f1792d2d9820d174",
            "author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "real_author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "date": "2013-06-18 22:09:05.000000000",
            "message": "Patch Set 1: (1 inline comment)\n\nMissing tests but wanted to put out there to gauge the idea, would something like this work?",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "8f0ca83489dd620f2b53c01e8cfe683252c05ce8",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-06-18 22:34:47.000000000",
            "message": "Patch Set 1: Works for me\n\nSmokeStack Results (patch set 1):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/92059\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "6a71fac046053486cf0b5aed2f6345406d8c2049",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-06-18 23:01:59.000000000",
            "message": "Patch Set 1: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/33550/1/check/gate-glance-pep8/4981 : SUCCESS in 2m 42s\n- http://docs-draft.openstack.org/33550/1/check/gate-glance-docs/3009/doc/build/html/ : SUCCESS in 2m 33s\n- http://logs.openstack.org/33550/1/check/gate-glance-python26/4426 : SUCCESS in 9m 32s\n- http://logs.openstack.org/33550/1/check/gate-glance-python27/4457 : SUCCESS in 6m 55s\n- http://logs.openstack.org/33550/1/check/gate-tempest-devstack-vm-full/24402 : SUCCESS in 41m 08s\n- http://logs.openstack.org/33550/1/check/gate-tempest-devstack-vm-postgres-full/24108 : SUCCESS in 51m 24s\n- http://logs.openstack.org/33550/1/check/gate-tempest-devstack-vm-quantum/31865 : SUCCESS in 20m 31s\n- http://logs.openstack.org/33550/1/check/gate-grenade-devstack-vm/11265 : FAILURE in 39m 03s (non-voting)\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "4cd244a1c4c28c1853b7591b7fadcfe839675c62",
            "author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "real_author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "date": "2013-06-19 19:25:10.000000000",
            "message": "Uploaded patch set 2.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "079d634c43b988ab2b0daf3135d6ee021f4257cf",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-06-19 19:46:57.000000000",
            "message": "Patch Set 2: Works for me\n\nSmokeStack Results (patch set 2):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/92338\n",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "90e3f69ae56b50cb82fa0ca70321623f331cfa10",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-06-19 20:15:37.000000000",
            "message": "Patch Set 2: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/33550/2/check/gate-glance-pep8/4984 : SUCCESS in 1m 34s\n- http://docs-draft.openstack.org/33550/2/check/gate-glance-docs/3012/doc/build/html/ : SUCCESS in 1m 41s\n- http://logs.openstack.org/33550/2/check/gate-glance-python26/4429 : SUCCESS in 9m 32s\n- http://logs.openstack.org/33550/2/check/gate-glance-python27/4460 : SUCCESS in 7m 04s\n- http://logs.openstack.org/33550/2/check/gate-tempest-devstack-vm-full/24728 : SUCCESS in 43m 34s\n- http://logs.openstack.org/33550/2/check/gate-tempest-devstack-vm-postgres-full/24434 : SUCCESS in 50m 18s\n- http://logs.openstack.org/33550/2/check/gate-tempest-devstack-vm-quantum/32219 : SUCCESS in 20m 18s\n- http://logs.openstack.org/33550/2/check/gate-grenade-devstack-vm/11537 : FAILURE in 37m 42s (non-voting)\n",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "a39283ba5ab09550227c35b8d8d7e79d57d9e418",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2013-06-24 20:43:32.000000000",
            "message": "Patch Set 2: I would prefer that you didn't merge this\n\nThank you for highlighting this issue with working code.\n\nI would prefer that we solve this in a less nova specific way.  We should re-visit the externally exposed states of a glance image and their transitions.  A user should certainly be able to transition from a new state to an error state (and associating error information seems perfectly reasonable as well).  However I think this should be designed in and not worked around.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "df921aac7b32e693ef84fddbb86dfeca6d7cfcbb",
            "author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "real_author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "date": "2013-06-26 21:35:25.000000000",
            "message": "Patch Set 2:\n\nJohn I tend to agree with you, do you want to work that other approach in a blueprint, I can help with implementation and blueprint design.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "bf9a63f7fdf4e8ad978d67d9b21ba2871bcaf4ca",
            "author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "real_author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "date": "2013-06-26 21:40:01.000000000",
            "message": "Patch Set 2:\n\nWould something like this work? Allow image state to be updated to error state only if currently in queue state. This update request will also bring an error property that could be added to the image for inspection later.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "2745b1b5065ef0d4249589781c780746e608f6c3",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-06-29 16:02:34.000000000",
            "message": "Patch Set 2: I would prefer that you didn't merge this\n\nI'm starting to feel like a bit of a broken record.\n\nI don't think it makes sense for glance to track nova's snapshot task flow. If a nova snapshot action fails, it is nova's responsibility to report that fact and to try to clean up resources.\n\nA snapshot is not an asynchronous action for glance. Its just a regular upload. We report the success and failure of regular uploads through the http response. If you fail an upload, we should *not* be setting the image to killed.\n\nHaving glance behave differently based on an image property seems a bit nasty.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "ec0712b67edb8da5ea7403ef76e0dbd059c2fbae",
            "author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "real_author": {
                "_account_id": 5313,
                "name": "David Peraza",
                "email": "david_peraza@persistentsys.com",
                "username": "dperaza"
            },
            "date": "2013-07-01 14:23:06.000000000",
            "message": "Patch Set 2:\n\nThanks for comments Mark, I see you feel strong about this, and I understand the reasons. I do have a few question that will let me understand a bit better, lets forget about nova for a moment and just look at a normal client/server flow where more than one client are looking at the image. When a client A creates and image and those not provide image to upload nor location, the image is put in queue state, which looks like it means I'm waiting for the image data. Mean time client B starts tracking states of the image in question. I client A can't not provide the image nor location because of whatever error, how does client B know something is wrong vs still waiting for image to be uploaded? I think we need a way to tell client B that this image is not waiting for upload anymore, but it is not usable (kill, error... some state that indicate something is not right will be useful, considering image is bad on timeouts could work but could be an issue if images are big and things do take time as a matter of normal business. \n\nI do realize this patch is nova specific but I was just trying to show a real scenario that happens all the time vs just theory with above usecase. I agree that using props to change state is ungly I think we should update state to change state, but I need to get green light from more experience folks on this.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "975d4f7e124f6d22d194910c69d6daef789407c7",
            "author": {
                "_account_id": 9,
                "name": "LaunchpadSync",
                "username": "launchpadsync"
            },
            "real_author": {
                "_account_id": 9,
                "name": "LaunchpadSync",
                "username": "launchpadsync"
            },
            "date": "2013-07-09 06:03:06.000000000",
            "message": "Patch Set 2: Abandoned\n\ncode review expired after 1 week of no activity after a negative review, it can be restored using the `Restore Change` button under the Patch Set on the web interface",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "925ad3429d238b5033a973c56134dd10aaf7ace9",
            "author": {
                "_account_id": 9,
                "name": "LaunchpadSync",
                "username": "launchpadsync"
            },
            "real_author": {
                "_account_id": 9,
                "name": "LaunchpadSync",
                "username": "launchpadsync"
            },
            "date": "2013-07-09 06:03:06.000000000",
            "message": "Patch Set 2:\n\ncode review expired after 1 week of no activity after a negative review, it can be restored using the `Restore Change` button under the Patch Set on the web interface",
            "accounts_in_message": [],
            "_revision_number": 2
        }
    ],
    "requirements": [],
    "submit_records": []
}
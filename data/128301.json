{
    "id": "openstack%2Fglance~master~Ifad403e363daf368e846b5b6838432a7bedbe81a",
    "project": "openstack/glance",
    "branch": "master",
    "topic": "bug/1378215",
    "hashtags": [],
    "change_id": "Ifad403e363daf368e846b5b6838432a7bedbe81a",
    "subject": "Can not delete images if db deadlock occurs",
    "status": "MERGED",
    "created": "2014-10-14 14:17:59.000000000",
    "updated": "2014-10-21 19:05:27.000000000",
    "submitted": "2014-10-17 20:14:06.000000000",
    "submitter": {
        "_account_id": 3,
        "name": "Jenkins",
        "username": "jenkins"
    },
    "insertions": 12,
    "deletions": 0,
    "total_comment_count": 0,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "b0693a96e125631c147f96f04c1090f1e24f5c84",
    "_number": 128301,
    "owner": {
        "_account_id": 10485,
        "name": "Ankit Agrawal",
        "email": "ankitagrawal8188@gmail.com",
        "username": "ankitagrawal"
    },
    "labels": {
        "Verified": {
            "approved": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 11356,
                    "name": "Louis Taylor",
                    "email": "louis@kragniz.eu",
                    "username": "kragniz"
                },
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 8127,
                    "name": "Alexander Tivelkov",
                    "email": "locher@yandex.ru",
                    "username": "ativelkov"
                },
                {
                    "value": 0,
                    "_account_id": 4,
                    "name": "Dolph Mathews",
                    "email": "dolph.mathews@gmail.com",
                    "username": "dolph"
                },
                {
                    "value": 0,
                    "date": "2014-10-14 15:39:28.000000000",
                    "_account_id": 10485,
                    "name": "Ankit Agrawal",
                    "email": "ankitagrawal8188@gmail.com",
                    "username": "ankitagrawal"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "date": "2014-10-14 15:28:32.000000000",
                    "_account_id": 8871,
                    "name": "Elastic Recheck",
                    "username": "elasticrecheck"
                },
                {
                    "value": 0,
                    "date": "2014-10-16 13:49:32.000000000",
                    "_account_id": 455,
                    "name": "Stuart McLaren",
                    "email": "stuart.mclaren@hpe.com",
                    "username": "stuart-mclaren"
                },
                {
                    "value": 2,
                    "date": "2014-10-17 20:14:06.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "approved": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "recommended": {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            },
            "all": [
                {
                    "value": 1,
                    "date": "2014-10-16 13:32:46.000000000",
                    "permitted_voting_range": {
                        "min": 1,
                        "max": 1
                    },
                    "_account_id": 11356,
                    "name": "Louis Taylor",
                    "email": "louis@kragniz.eu",
                    "username": "kragniz"
                },
                {
                    "value": 2,
                    "date": "2014-10-17 18:53:49.000000000",
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 1,
                    "date": "2014-10-17 10:19:41.000000000",
                    "permitted_voting_range": {
                        "min": 1,
                        "max": 1
                    },
                    "_account_id": 8127,
                    "name": "Alexander Tivelkov",
                    "email": "locher@yandex.ru",
                    "username": "ativelkov"
                },
                {
                    "value": 0,
                    "_account_id": 4,
                    "name": "Dolph Mathews",
                    "email": "dolph.mathews@gmail.com",
                    "username": "dolph"
                },
                {
                    "value": 0,
                    "_account_id": 10485,
                    "name": "Ankit Agrawal",
                    "email": "ankitagrawal8188@gmail.com",
                    "username": "ankitagrawal"
                },
                {
                    "value": 2,
                    "date": "2014-10-17 10:24:44.000000000",
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 8871,
                    "name": "Elastic Recheck",
                    "username": "elasticrecheck"
                },
                {
                    "value": 2,
                    "date": "2014-10-17 09:39:37.000000000",
                    "_account_id": 455,
                    "name": "Stuart McLaren",
                    "email": "stuart.mclaren@hpe.com",
                    "username": "stuart-mclaren"
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "value": 1,
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "approved": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 11356,
                    "name": "Louis Taylor",
                    "email": "louis@kragniz.eu",
                    "username": "kragniz"
                },
                {
                    "value": 1,
                    "date": "2014-10-17 18:53:49.000000000",
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 8127,
                    "name": "Alexander Tivelkov",
                    "email": "locher@yandex.ru",
                    "username": "ativelkov"
                },
                {
                    "value": 0,
                    "date": "2014-10-14 14:22:50.000000000",
                    "_account_id": 4,
                    "name": "Dolph Mathews",
                    "email": "dolph.mathews@gmail.com",
                    "username": "dolph"
                },
                {
                    "value": 0,
                    "_account_id": 10485,
                    "name": "Ankit Agrawal",
                    "email": "ankitagrawal8188@gmail.com",
                    "username": "ankitagrawal"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 8871,
                    "name": "Elastic Recheck",
                    "username": "elasticrecheck"
                },
                {
                    "value": 0,
                    "_account_id": 455,
                    "name": "Stuart McLaren",
                    "email": "stuart.mclaren@hpe.com",
                    "username": "stuart-mclaren"
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "value": 0,
                    "_account_id": 11356,
                    "name": "Louis Taylor",
                    "email": "louis@kragniz.eu",
                    "username": "kragniz"
                },
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 8127,
                    "name": "Alexander Tivelkov",
                    "email": "locher@yandex.ru",
                    "username": "ativelkov"
                },
                {
                    "value": 0,
                    "_account_id": 4,
                    "name": "Dolph Mathews",
                    "email": "dolph.mathews@gmail.com",
                    "username": "dolph"
                },
                {
                    "value": 0,
                    "_account_id": 10485,
                    "name": "Ankit Agrawal",
                    "email": "ankitagrawal8188@gmail.com",
                    "username": "ankitagrawal"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 8871,
                    "name": "Elastic Recheck",
                    "username": "elasticrecheck"
                },
                {
                    "value": 0,
                    "_account_id": 455,
                    "name": "Stuart McLaren",
                    "email": "stuart.mclaren@hpe.com",
                    "username": "stuart-mclaren"
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 4,
                "name": "Dolph Mathews",
                "email": "dolph.mathews@gmail.com",
                "username": "dolph"
            },
            {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            {
                "_account_id": 8127,
                "name": "Alexander Tivelkov",
                "email": "locher@yandex.ru",
                "username": "ativelkov"
            },
            {
                "_account_id": 8871,
                "name": "Elastic Recheck",
                "username": "elasticrecheck"
            },
            {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2014-10-14 14:22:50.000000000",
            "updated_by": {
                "_account_id": 4,
                "name": "Dolph Mathews",
                "email": "dolph.mathews@gmail.com",
                "username": "dolph"
            },
            "reviewer": {
                "_account_id": 4,
                "name": "Dolph Mathews",
                "email": "dolph.mathews@gmail.com",
                "username": "dolph"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-14 15:28:32.000000000",
            "updated_by": {
                "_account_id": 8871,
                "name": "Elastic Recheck",
                "username": "elasticrecheck"
            },
            "reviewer": {
                "_account_id": 8871,
                "name": "Elastic Recheck",
                "username": "elasticrecheck"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-16 13:32:46.000000000",
            "updated_by": {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            },
            "reviewer": {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-16 13:49:32.000000000",
            "updated_by": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "reviewer": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-17 10:19:41.000000000",
            "updated_by": {
                "_account_id": 8127,
                "name": "Alexander Tivelkov",
                "email": "locher@yandex.ru",
                "username": "ativelkov"
            },
            "reviewer": {
                "_account_id": 8127,
                "name": "Alexander Tivelkov",
                "email": "locher@yandex.ru",
                "username": "ativelkov"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-17 10:24:44.000000000",
            "updated_by": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "reviewer": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-17 18:53:49.000000000",
            "updated_by": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "reviewer": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2014-10-17 20:14:06.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "735d1a3f0adce60cef8c2822f02d72292ca5c691",
            "author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "real_author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "date": "2014-10-14 14:17:59.000000000",
            "message": "Uploaded patch set 1.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "216600f3b7ad96b4a0d0aa6ecd0a6b0217ce28e7",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2014-10-14 15:28:19.000000000",
            "message": "Patch Set 1: Verified-1\n\nBuild failed.  For information on how to proceed, see https://wiki.openstack.org/wiki/GerritJenkinsGit#Test_Failures\n\n- gate-glance-pep8 http://logs.openstack.org/01/128301/1/check/gate-glance-pep8/35507f6 : SUCCESS in 2m 19s\n- gate-glance-docs http://docs-draft.openstack.org/01/128301/1/check/gate-glance-docs/93b090f/doc/build/html/ : SUCCESS in 2m 21s\n- gate-glance-python26 http://logs.openstack.org/01/128301/1/check/gate-glance-python26/ccee44b : SUCCESS in 5m 06s\n- gate-glance-python27 http://logs.openstack.org/01/128301/1/check/gate-glance-python27/f910c58 : SUCCESS in 5m 25s\n- check-tempest-dsvm-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-full/d59fd3b : FAILURE in 1h 01m 50s\n- check-tempest-dsvm-postgres-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-postgres-full/ffa0475 : SUCCESS in 1h 00m 16s\n- check-tempest-dsvm-neutron-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-neutron-full/a8a9704 : SUCCESS in 1h 05m 54s\n- check-tempest-dsvm-neutron-heat-slow http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-neutron-heat-slow/a5be159 : SUCCESS in 24m 08s\n- check-grenade-dsvm http://logs.openstack.org/01/128301/1/check/check-grenade-dsvm/7eafcd8 : SUCCESS in 53m 09s\n- gate-tempest-dsvm-large-ops http://logs.openstack.org/01/128301/1/check/gate-tempest-dsvm-large-ops/dd91f87 : SUCCESS in 24m 55s\n- gate-tempest-dsvm-neutron-large-ops http://logs.openstack.org/01/128301/1/check/gate-tempest-dsvm-neutron-large-ops/301271c : SUCCESS in 18m 21s\n- check-devstack-dsvm-cells http://logs.openstack.org/01/128301/1/check/check-devstack-dsvm-cells/034f3a2 : SUCCESS in 15m 49s\n- gate-rally-dsvm-glance http://logs.openstack.org/01/128301/1/check/gate-rally-dsvm-glance/d98ce9d : SUCCESS in 18m 54s (non-voting)",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "38da2269b69119a0af48125261eebcd9c2853716",
            "author": {
                "_account_id": 8871,
                "name": "Elastic Recheck",
                "username": "elasticrecheck"
            },
            "real_author": {
                "_account_id": 8871,
                "name": "Elastic Recheck",
                "username": "elasticrecheck"
            },
            "date": "2014-10-14 15:28:32.000000000",
            "message": "Patch Set 1:\n\nI noticed jenkins failed, I think you hit bug(s):\n\n- check-tempest-dsvm-full: https://bugs.launchpad.net/bugs/1352498 https://bugs.launchpad.net/bugs/1348204 https://bugs.launchpad.net/bugs/1374458\n\nIf you believe we've correctly identified the failure, feel free to leave a 'recheck' comment to run the tests again.\nFor more details on this and other bugs, please see http://status.openstack.org/elastic-recheck/",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "6544dadc6e9ee3608b5bb7dc1bd2b36152ea90c3",
            "author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "real_author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "date": "2014-10-14 15:39:28.000000000",
            "message": "Patch Set 1:\n\nrecheck bug 1374458",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "65df43b1aec215d2d4241e0e1c833d14ebf65b66",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2014-10-14 16:53:23.000000000",
            "message": "Patch Set 1: Verified+1\n\nBuild succeeded (check pipeline).\n\n- gate-glance-pep8 http://logs.openstack.org/01/128301/1/check/gate-glance-pep8/22de054 : SUCCESS in 1m 51s\n- gate-glance-docs http://docs-draft.openstack.org/01/128301/1/check/gate-glance-docs/f7cf1ed/doc/build/html/ : SUCCESS in 1m 46s\n- gate-glance-python26 http://logs.openstack.org/01/128301/1/check/gate-glance-python26/c3b5f5b : SUCCESS in 5m 33s\n- gate-glance-python27 http://logs.openstack.org/01/128301/1/check/gate-glance-python27/81db3fa : SUCCESS in 4m 05s\n- check-tempest-dsvm-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-full/db64435 : SUCCESS in 59m 30s\n- check-tempest-dsvm-postgres-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-postgres-full/99b62c2 : SUCCESS in 49m 25s\n- check-tempest-dsvm-neutron-full http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-neutron-full/3c9676c : SUCCESS in 1h 04m 37s\n- check-tempest-dsvm-neutron-heat-slow http://logs.openstack.org/01/128301/1/check/check-tempest-dsvm-neutron-heat-slow/c232222 : SUCCESS in 22m 45s\n- check-grenade-dsvm http://logs.openstack.org/01/128301/1/check/check-grenade-dsvm/7868f57 : SUCCESS in 45m 13s\n- gate-tempest-dsvm-large-ops http://logs.openstack.org/01/128301/1/check/gate-tempest-dsvm-large-ops/e2910aa : SUCCESS in 18m 40s\n- gate-tempest-dsvm-neutron-large-ops http://logs.openstack.org/01/128301/1/check/gate-tempest-dsvm-neutron-large-ops/5cbe7ad : SUCCESS in 19m 22s\n- check-devstack-dsvm-cells http://logs.openstack.org/01/128301/1/check/check-devstack-dsvm-cells/437294b : SUCCESS in 13m 45s\n- gate-rally-dsvm-glance http://logs.openstack.org/01/128301/1/check/gate-rally-dsvm-glance/fab1cf3 : SUCCESS in 21m 53s (non-voting)",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "0d722971d135f133d0b4a4f81abb06aab8f0dd28",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2014-10-14 17:16:29.000000000",
            "message": "Patch Set 1: Code-Review-1\n\nlooks good, just a question:  How will this work with the newly proposed timeout client socket timeout patch?  In that patch a connection will be closed if idle for a configurable amount of time (default 900 seconds).  It looks like this one will stop retrying after 250 seconds + overhead.  What happens to the threads handling this if the client timeout is lowered below 250 seconds?",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "6a94d8a80bca74f4a748b6e8c184a6a006fa0907",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2014-10-16 04:25:31.000000000",
            "message": "Patch Set 1:\n\nI'm interested in the same question which John asked above.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "bf126887b8435269d53dda735fbbfe449cb2ffeb",
            "author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "real_author": {
                "_account_id": 10485,
                "name": "Ankit Agrawal",
                "email": "ankitagrawal8188@gmail.com",
                "username": "ankitagrawal"
            },
            "date": "2014-10-16 06:09:59.000000000",
            "message": "Patch Set 1:\n\nHi John/Zhi Yan,\n\nIMO 'client_socket_timeout' patch 'https://review.openstack.org/#/c/119132/' will not effect the above patch because 'client_socket_timeout' patch allows closing idle client connections after a period of time but retry decorator is continuously retrying on 'image_destroy' method and client connection is not idle in this case.\n\nI followed following steps to test this scenario:\n\n1. Applied patch 'https://review.openstack.org/#/c/119132/' on this retry on db_deadlock patch.\n2. Set 'client_socket_timeout' to 60 seconds in glance-api.conf and glance-registry.conf.\n3. Updated retry count to 500 in retry decorator and add a delay of 1 sec in 'image_destroy' method.\n4. Raise db_exception.DBDeadlock to simulate the exception.\n5. Restart glance-api and glance-registry services.\n6. Delete an image.\n7. It retries 500 times to call 'image_destroy' even after exceeding the client_socket_timeout (60 sec).\n\nPlease let me know your suggestions.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "62d1d0dfaad96c08944b8e7274f8eef3356defe2",
            "author": {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            },
            "real_author": {
                "_account_id": 11356,
                "name": "Louis Taylor",
                "email": "louis@kragniz.eu",
                "username": "kragniz"
            },
            "date": "2014-10-16 13:32:46.000000000",
            "message": "Patch Set 1: Code-Review+1\n\nThat behavior looks good to me. Retrying means the connection is not idle.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "bea2ac141625c499e84ee1f49fb977b391350925",
            "author": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "real_author": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "date": "2014-10-16 13:49:32.000000000",
            "message": "Patch Set 1:\n\nThe socket timeout patch times out the connection from the glance client to the glance api. This isn't the same as the socket from the (say) glance registry to the glance db.\n\nI think the effect of the new timeout triggering while the db call is being retried would be the same as the current behaviour if, for example, the client died unexpectedly.\n\nIt's probably worth testing what that is. (This type of decorator is already being used so it's possible we could hit a dead client scenario with the existing code.)",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "5dcfd5fd176d0c316ce9619abd337961c94e9b4d",
            "author": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "real_author": {
                "_account_id": 455,
                "name": "Stuart McLaren",
                "email": "stuart.mclaren@hpe.com",
                "username": "stuart-mclaren"
            },
            "date": "2014-10-17 09:39:37.000000000",
            "message": "Patch Set 1: Code-Review+2\n\nI think John's query is a good one, and we should look into it, but I don't see it as a reason to block this patch which fixes a known issue (and doesn't introduce any known new failure modes) and is consistent with the existing wrapper around _image_update.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "72691abe4ce5531412e320fc375361226533ef1e",
            "author": {
                "_account_id": 8127,
                "name": "Alexander Tivelkov",
                "email": "locher@yandex.ru",
                "username": "ativelkov"
            },
            "real_author": {
                "_account_id": 8127,
                "name": "Alexander Tivelkov",
                "email": "locher@yandex.ru",
                "username": "ativelkov"
            },
            "date": "2014-10-17 10:19:41.000000000",
            "message": "Patch Set 1: Code-Review+1",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "f68bf9b0fe7d050d8b7b8f11a042767ac0a51d7d",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2014-10-17 10:24:44.000000000",
            "message": "Patch Set 1: Code-Review+2\n\nAgreed to move forward first. Let's do more check on client stock timeout case, and do a separated MP if needed.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "5120eab5dc98f5fa99aee5557f0965d4f099c792",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2014-10-17 18:53:49.000000000",
            "message": "Patch Set 1: Code-Review+2 Workflow+1\n\nMakes sense.  Stuart's point is taken as well.  Thanks!",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "821b743908b756a2e8a4aa661914153c53991ec4",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2014-10-17 18:53:50.000000000",
            "message": "Patch Set 1: -Verified\n\nStarting gate jobs.\nhttp://status.openstack.org/zuul/",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "755af74dbe801d6fb2696c3eadee230581603538",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2014-10-17 20:14:06.000000000",
            "message": "Patch Set 1: Verified+2\n\nBuild succeeded (gate pipeline).\n\n- gate-glance-docs http://docs-draft.openstack.org/01/128301/1/gate/gate-glance-docs/4592495/doc/build/html/ : SUCCESS in 2m 18s\n- gate-glance-pep8 http://logs.openstack.org/01/128301/1/gate/gate-glance-pep8/6f82d75 : SUCCESS in 1m 58s\n- gate-glance-python26 http://logs.openstack.org/01/128301/1/gate/gate-glance-python26/a0b7f9e : SUCCESS in 5m 01s\n- gate-glance-python27 http://logs.openstack.org/01/128301/1/gate/gate-glance-python27/ff4c4d0 : SUCCESS in 4m 36s\n- gate-tempest-dsvm-full http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-full/d43439a : SUCCESS in 53m 52s\n- gate-tempest-dsvm-postgres-full http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-postgres-full/0f5c3c7 : SUCCESS in 48m 19s\n- gate-tempest-dsvm-neutron-full http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-neutron-full/d30dfa8 : SUCCESS in 55m 18s\n- gate-tempest-dsvm-neutron-heat-slow http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-neutron-heat-slow/60ecf62 : SUCCESS in 23m 30s\n- gate-grenade-dsvm http://logs.openstack.org/01/128301/1/gate/gate-grenade-dsvm/3de2bf4 : SUCCESS in 45m 51s\n- gate-tempest-dsvm-large-ops http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-large-ops/a65168b : SUCCESS in 19m 39s\n- gate-tempest-dsvm-neutron-large-ops http://logs.openstack.org/01/128301/1/gate/gate-tempest-dsvm-neutron-large-ops/ba84b65 : SUCCESS in 18m 44s\n- gate-devstack-dsvm-cells http://logs.openstack.org/01/128301/1/gate/gate-devstack-dsvm-cells/f0f8577 : SUCCESS in 15m 37s",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "cf9daf16e88336bb5ffc811ea1552e198a0b9dff",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2014-10-17 20:14:07.000000000",
            "message": "Change has been successfully merged into the git repository.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "13a52e2b347fc24233ad4af68c542107a73d6931",
            "author": {
                "_account_id": 9303,
                "name": "Abhishek Kekane",
                "email": "akekane@redhat.com",
                "username": "abhishekkekane"
            },
            "real_author": {
                "_account_id": 9303,
                "name": "Abhishek Kekane",
                "email": "akekane@redhat.com",
                "username": "abhishekkekane"
            },
            "date": "2014-10-21 19:05:27.000000000",
            "message": "Patch Set 1: Cherry Picked\n\nThis patchset was cherry picked to branch stable/juno as commit 41e143b2172a36e4f49bc7e3a1ed97ee8477afb9",
            "accounts_in_message": [],
            "_revision_number": 1
        }
    ],
    "requirements": [],
    "submit_records": []
}
{
    "id": "openstack%2Fglance~master~I2a5f49bb035d08d1c0ebaf966379eefdffa34060",
    "project": "openstack/glance",
    "branch": "master",
    "topic": "493231",
    "hashtags": [],
    "change_id": "I2a5f49bb035d08d1c0ebaf966379eefdffa34060",
    "subject": "Add a middleware to leverage uwsgi chunk api",
    "status": "ABANDONED",
    "created": "2017-08-11 20:49:03.000000000",
    "updated": "2017-08-15 17:25:46.000000000",
    "insertions": 59,
    "deletions": 8,
    "total_comment_count": 4,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "a9362726f02ed3932b9638cb33a73b888d98439e",
    "_number": 493231,
    "owner": {
        "_account_id": 5196,
        "name": "Matthew Treinish",
        "email": "mtreinish@kortar.org",
        "username": "treinish"
    },
    "labels": {
        "Verified": {
            "recommended": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "all": [
                {
                    "_account_id": 11564,
                    "name": "Chris Dent",
                    "email": "cdent@anticdent.org",
                    "username": "chdent"
                },
                {
                    "date": "2017-08-11 21:40:02.000000000",
                    "_account_id": 5196,
                    "name": "Matthew Treinish",
                    "email": "mtreinish@kortar.org",
                    "username": "treinish"
                },
                {
                    "_account_id": 14070,
                    "name": "Eric Fried",
                    "email": "openstack@fried.cc",
                    "username": "efried"
                },
                {
                    "value": 1,
                    "date": "2017-08-11 23:44:44.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "value": 1,
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "disliked": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "all": [
                {
                    "value": -1,
                    "date": "2017-08-11 22:22:40.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 11564,
                    "name": "Chris Dent",
                    "email": "cdent@anticdent.org",
                    "username": "chdent"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 5196,
                    "name": "Matthew Treinish",
                    "email": "mtreinish@kortar.org",
                    "username": "treinish"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 14070,
                    "name": "Eric Fried",
                    "email": "openstack@fried.cc",
                    "username": "efried"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "value": -1,
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "all": [
                {
                    "_account_id": 11564,
                    "name": "Chris Dent",
                    "email": "cdent@anticdent.org",
                    "username": "chdent"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 0
                    },
                    "_account_id": 5196,
                    "name": "Matthew Treinish",
                    "email": "mtreinish@kortar.org",
                    "username": "treinish"
                },
                {
                    "date": "2017-08-14 18:49:26.000000000",
                    "_account_id": 14070,
                    "name": "Eric Fried",
                    "email": "openstack@fried.cc",
                    "username": "efried"
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "_account_id": 11564,
                    "name": "Chris Dent",
                    "email": "cdent@anticdent.org",
                    "username": "chdent"
                },
                {
                    "_account_id": 5196,
                    "name": "Matthew Treinish",
                    "email": "mtreinish@kortar.org",
                    "username": "treinish"
                },
                {
                    "_account_id": 14070,
                    "name": "Eric Fried",
                    "email": "openstack@fried.cc",
                    "username": "efried"
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            {
                "_account_id": 14070,
                "name": "Eric Fried",
                "email": "openstack@fried.cc",
                "username": "efried"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2017-08-11 22:22:40.000000000",
            "updated_by": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "reviewer": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2017-08-11 23:44:44.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2017-08-14 18:49:26.000000000",
            "updated_by": {
                "_account_id": 14070,
                "name": "Eric Fried",
                "email": "openstack@fried.cc",
                "username": "efried"
            },
            "reviewer": {
                "_account_id": 14070,
                "name": "Eric Fried",
                "email": "openstack@fried.cc",
                "username": "efried"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "716688291264feb2de3a7a1bca5e32a848848aec",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-11 20:49:03.000000000",
            "message": "Uploaded patch set 1.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "2a0b05644d8c653943724fbe6d2bf4aeab55b6d2",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-11 21:32:13.000000000",
            "message": "Uploaded patch set 2.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "db8cf4983469d1ae751a486712c294347314db82",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-11 21:40:02.000000000",
            "message": "Patch Set 2:\n\nThe only problem with this currently is that it stores the entire image upload in memory until glance writes it to the configured store and it's cleaned up. This obviously won't scale for a lot of use cases. I'm trying to figure out the best way to store it as a temp file or something prior instead of writing it to memory. I haven't figured out exactly how eventlet is handling this problem though. (if it does)",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "7bca8322ac1865c57e7888663d520c312d777221",
            "author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "real_author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "date": "2017-08-11 22:22:40.000000000",
            "message": "Patch Set 2: Code-Review-1\n\n(2 comments)\n\nA good idea, but the memory issue is a stopper.\n\nI'm going to assume this is a \"just to see if it works\", but just in case, the -1 is to say \"oi, no!\"",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "a4bcae496f5765b7d897792c737597a2fb731377",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-11 22:50:03.000000000",
            "message": "Patch Set 2:\n\nYeah, it was just to see if it works, and also to save where my experiments are before I called it EOD. The trick here is gonna be mapping the req.body object to something webob will understand. From what I could see image data is only accessed from the webob Request body_file property: \n\nhttps://github.com/Pylons/webob/blob/master/src/webob/request.py#L246\n\nWhich should give us the hints we need to make sure we're translating the chunked_read() calls into something glance can use.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "19fd7f81f7172ba08483df3a6aea8287869df302",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2017-08-11 23:44:44.000000000",
            "message": "Patch Set 2: Verified+1\n\nBuild succeeded (check pipeline).\n\n- gate-glance-python35 http://logs.openstack.org/31/493231/2/check/gate-glance-python35/7353c89/ : SUCCESS in 7m 48s\n- gate-glance-docs-ubuntu-xenial http://docs-draft.openstack.org/31/493231/2/check/gate-glance-docs-ubuntu-xenial/cbc3006//doc/build/html/ : SUCCESS in 7m 21s\n- gate-glance-pep8-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-glance-pep8-ubuntu-xenial/735fbf2/ : SUCCESS in 7m 06s\n- gate-glance-python27-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-glance-python27-ubuntu-xenial/d0d2ba7/ : SUCCESS in 8m 11s\n- gate-tempest-dsvm-neutron-full-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/613b2ce/ : SUCCESS in 1h 41m 20s\n- gate-grenade-dsvm-neutron-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-grenade-dsvm-neutron-ubuntu-xenial/38377b0/ : SUCCESS in 1h 13m 48s\n- gate-tempest-dsvm-py35-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-tempest-dsvm-py35-ubuntu-xenial/4cc8c93/ : SUCCESS in 1h 28m 27s\n- gate-tempest-dsvm-full-devstack-plugin-ceph-ubuntu-xenial http://logs.openstack.org/31/493231/2/check/gate-tempest-dsvm-full-devstack-plugin-ceph-ubuntu-xenial/c256741/ : SUCCESS in 1h 14m 33s (non-voting)\n- gate-rally-dsvm-glance-ubuntu-xenial-nv http://logs.openstack.org/31/493231/2/check/gate-rally-dsvm-glance-ubuntu-xenial-nv/6284b43/ : FAILURE in 31m 04s (non-voting)\n- gate-rally-dsvm-py35-glance-nv http://logs.openstack.org/31/493231/2/check/gate-rally-dsvm-py35-glance-nv/8489e68/ : FAILURE in 35m 16s (non-voting)",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "66d5bb264c75cae6bd8b74fd33a28169329fa7b5",
            "author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "real_author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "date": "2017-08-14 10:33:13.000000000",
            "message": "Patch Set 2:\n\nOne option might be to subclass WebOb.request.Request to implement our own guts of body_file (which is implemented as a property).\n\nI glanced (ha!) at this. My first impression is that it is doable but non-trivial.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "1120272cd54e4138adf7d8b58c28c3d69b7e2abc",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-14 14:38:47.000000000",
            "message": "Patch Set 2:\n\nYeah, that was something I looked at before doing this. But is was much more difficult to wrap my head around than this for a quick test. It might be what we have to end up doing, I just didn't have the patience on a Fri afternoon to figure out how to do the subclass properly. \n\nEspecially, because after taking a closer look at my eventlet example it looks like it dechunks on a read() or readline() call for the input. Which is how eventlet avoids the memory overhead, because glance only reads a fixed size from the body_file at a time.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "0ca401f299586aa2cf5c0466532a47808015efb2",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-14 16:44:31.000000000",
            "message": "Patch Set 2:\n\n(1 comment)",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "f5fbffaa424bc767e0949aa76420f73667056047",
            "author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "real_author": {
                "_account_id": 11564,
                "name": "Chris Dent",
                "email": "cdent@anticdent.org",
                "username": "chdent"
            },
            "date": "2017-08-14 16:46:02.000000000",
            "message": "Patch Set 2:\n\n(1 comment)\n\nuwsgi is weird, but powerful",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "42dc6d95f3fb1f7ddbb4863952f6a56b8c4c640a",
            "author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "real_author": {
                "_account_id": 5196,
                "name": "Matthew Treinish",
                "email": "mtreinish@kortar.org",
                "username": "treinish"
            },
            "date": "2017-08-15 17:25:46.000000000",
            "message": "Abandoned\n\nThis is superseded by: https://review.openstack.org/#/c/493654/",
            "accounts_in_message": [],
            "_revision_number": 2
        }
    ],
    "requirements": [],
    "submit_records": []
}
{
    "id": "openstack%2Fglance~master~I9a58393b599aacc427cb4135988ecf5c3e90e455",
    "project": "openstack/glance",
    "branch": "master",
    "hashtags": [],
    "change_id": "I9a58393b599aacc427cb4135988ecf5c3e90e455",
    "subject": "Using unicode() convert non-English exception message",
    "status": "MERGED",
    "created": "2013-07-17 08:27:19.000000000",
    "updated": "2013-08-08 16:17:35.000000000",
    "submitted": "2013-08-08 09:24:03.000000000",
    "submitter": {
        "_account_id": 3,
        "name": "Jenkins",
        "username": "jenkins"
    },
    "insertions": 58,
    "deletions": 3,
    "total_comment_count": 6,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "9b02d849c8940aa5a5c47b381fc91f6ce59fbb34",
    "_number": 37421,
    "owner": {
        "_account_id": 6549,
        "name": "Zhi Yan Liu",
        "email": "lzy.dev@gmail.com",
        "username": "lzy-dev"
    },
    "labels": {
        "Verified": {
            "approved": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "recommended": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 1390,
                    "name": "Paul Bourke",
                    "email": "pauldbourke@proton.me",
                    "username": "pauldbourke"
                },
                {
                    "value": 0,
                    "_account_id": 6159,
                    "name": "Flavio Percoco",
                    "display_name": "flaper87",
                    "email": "fpercoco@redhat.com",
                    "username": "flaper87"
                },
                {
                    "value": 0,
                    "_account_id": 7823,
                    "name": "Xiang Hui",
                    "email": "xianghuir@gmail.com",
                    "username": "xianghui"
                },
                {
                    "value": 0,
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 0,
                    "_account_id": 100,
                    "name": "Johannes Erdfelt",
                    "email": "johannes@erdfelt.com",
                    "username": "johannes.erdfelt"
                },
                {
                    "value": 0,
                    "_account_id": 6484,
                    "name": "Feilong Wang",
                    "email": "hustemb@gmail.com",
                    "username": "flwang"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 1,
                    "date": "2013-08-07 06:06:08.000000000",
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 2,
                    "date": "2013-08-08 09:24:03.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "value": 1,
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "approved": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 1390,
                    "name": "Paul Bourke",
                    "email": "pauldbourke@proton.me",
                    "username": "pauldbourke"
                },
                {
                    "value": 2,
                    "date": "2013-08-08 07:48:01.000000000",
                    "_account_id": 6159,
                    "name": "Flavio Percoco",
                    "display_name": "flaper87",
                    "email": "fpercoco@redhat.com",
                    "username": "flaper87"
                },
                {
                    "value": 0,
                    "_account_id": 7823,
                    "name": "Xiang Hui",
                    "email": "xianghuir@gmail.com",
                    "username": "xianghui"
                },
                {
                    "value": 2,
                    "date": "2013-08-07 16:11:32.000000000",
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": -1,
                    "date": "2013-08-07 17:02:00.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 100,
                    "name": "Johannes Erdfelt",
                    "email": "johannes@erdfelt.com",
                    "username": "johannes.erdfelt"
                },
                {
                    "value": 0,
                    "_account_id": 6484,
                    "name": "Feilong Wang",
                    "email": "hustemb@gmail.com",
                    "username": "flwang"
                },
                {
                    "value": 0,
                    "date": "2013-08-08 08:34:56.000000000",
                    "permitted_voting_range": {
                        "min": 0,
                        "max": 1
                    },
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "approved": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "all": [
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 1390,
                    "name": "Paul Bourke",
                    "email": "pauldbourke@proton.me",
                    "username": "pauldbourke"
                },
                {
                    "value": 1,
                    "date": "2013-08-08 07:48:01.000000000",
                    "_account_id": 6159,
                    "name": "Flavio Percoco",
                    "display_name": "flaper87",
                    "email": "fpercoco@redhat.com",
                    "username": "flaper87"
                },
                {
                    "value": 0,
                    "_account_id": 7823,
                    "name": "Xiang Hui",
                    "email": "xianghuir@gmail.com",
                    "username": "xianghui"
                },
                {
                    "value": 0,
                    "date": "2013-08-07 16:11:32.000000000",
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 0,
                    "_account_id": 100,
                    "name": "Johannes Erdfelt",
                    "email": "johannes@erdfelt.com",
                    "username": "johannes.erdfelt"
                },
                {
                    "value": 0,
                    "_account_id": 6484,
                    "name": "Feilong Wang",
                    "email": "hustemb@gmail.com",
                    "username": "flwang"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "value": 0,
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": 0,
                    "_account_id": 1390,
                    "name": "Paul Bourke",
                    "email": "pauldbourke@proton.me",
                    "username": "pauldbourke"
                },
                {
                    "value": 0,
                    "_account_id": 6159,
                    "name": "Flavio Percoco",
                    "display_name": "flaper87",
                    "email": "fpercoco@redhat.com",
                    "username": "flaper87"
                },
                {
                    "value": 0,
                    "_account_id": 7823,
                    "name": "Xiang Hui",
                    "email": "xianghuir@gmail.com",
                    "username": "xianghui"
                },
                {
                    "value": 0,
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 0,
                    "_account_id": 100,
                    "name": "Johannes Erdfelt",
                    "email": "johannes@erdfelt.com",
                    "username": "johannes.erdfelt"
                },
                {
                    "value": 0,
                    "_account_id": 6484,
                    "name": "Feilong Wang",
                    "email": "hustemb@gmail.com",
                    "username": "flwang"
                },
                {
                    "value": 0,
                    "_account_id": 6549,
                    "name": "Zhi Yan Liu",
                    "email": "lzy.dev@gmail.com",
                    "username": "lzy-dev"
                },
                {
                    "value": 0,
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            {
                "_account_id": 6484,
                "name": "Feilong Wang",
                "email": "hustemb@gmail.com",
                "username": "flwang"
            },
            {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            {
                "_account_id": 7823,
                "name": "Xiang Hui",
                "email": "xianghuir@gmail.com",
                "username": "xianghui"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2013-07-25 09:39:40.000000000",
            "updated_by": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "reviewer": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-07-25 11:16:05.000000000",
            "updated_by": {
                "_account_id": 7823,
                "name": "Xiang Hui",
                "email": "xianghuir@gmail.com",
                "username": "xianghui"
            },
            "reviewer": {
                "_account_id": 7823,
                "name": "Xiang Hui",
                "email": "xianghuir@gmail.com",
                "username": "xianghui"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-07-25 13:01:11.000000000",
            "updated_by": {
                "_account_id": 6484,
                "name": "Feilong Wang",
                "email": "hustemb@gmail.com",
                "username": "flwang"
            },
            "reviewer": {
                "_account_id": 6484,
                "name": "Feilong Wang",
                "email": "hustemb@gmail.com",
                "username": "flwang"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-05 11:33:41.000000000",
            "updated_by": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "reviewer": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-07 06:06:08.000000000",
            "updated_by": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "reviewer": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-07 16:11:32.000000000",
            "updated_by": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "reviewer": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-07 17:02:00.000000000",
            "updated_by": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "reviewer": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-08 07:48:01.000000000",
            "updated_by": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "reviewer": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-08-08 09:24:03.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "5985445d6290ecb7ca82f4b58dd5c6368130e179",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-07-17 08:50:19.000000000",
            "message": "Patch Set 1: Works for me\n\nSmokeStack Results (patch set 1):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/101756\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "c0358093e7d6bcc89e7e3d8e352536376852ef89",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-07-17 09:25:39.000000000",
            "message": "Patch Set 1: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/37421/1/check/gate-glance-pep8/5365 : SUCCESS in 1m 47s\n- http://docs-draft.openstack.org/37421/1/check/gate-glance-docs/3392/doc/build/html/ : SUCCESS in 2m 29s\n- http://logs.openstack.org/37421/1/check/gate-glance-python26/4803 : SUCCESS in 11m 18s\n- http://logs.openstack.org/37421/1/check/gate-glance-python27/4840 : SUCCESS in 9m 15s\n- http://logs.openstack.org/37421/1/check/gate-tempest-devstack-vm-full/33070 : SUCCESS in 56m 15s\n- http://logs.openstack.org/37421/1/check/gate-tempest-devstack-vm-cells-full/905 : FAILURE in 14m 05s (non-voting)\n- http://logs.openstack.org/37421/1/check/gate-tempest-devstack-vm-postgres-full/32760 : SUCCESS in 58m 15s\n- http://logs.openstack.org/37421/1/check/gate-tempest-devstack-vm-neutron/4688 : SUCCESS in 21m 20s (non-voting)\n- http://logs.openstack.org/37421/1/check/gate-grenade-devstack-vm/18914 : SUCCESS in 21m 30s (non-voting)\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "f6717f7d1ab80e6e6715ff256951854d9865ceab",
            "author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "real_author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "date": "2013-07-17 10:14:08.000000000",
            "message": "Patch Set 1: I would prefer that you didn't merge this\n\n2 questions:\n\n* Is this the only place this error can happen?  A quick grep for \"% e)\" would suggest there's more.\n\n* Would you mind taking a look at https://review.openstack.org/#/c/36658/ ?  Flavio seems to be looking to solve the exact same issue in python-glanceclient so would be nice to agree on a common solution.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "8c916ae5441612370a6918e132e440dc1a2b7c3d",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-07-17 14:13:36.000000000",
            "message": "Patch Set 1: I would prefer that you didn't merge this\n\n(1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "ed8afd444b423237fc77f58154f85199fe997155",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-18 05:15:46.000000000",
            "message": "Uploaded patch set 2.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "1b83f0e933c523f99c89a2795b021a58bd57c193",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-18 05:17:47.000000000",
            "message": "Patch Set 1: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "66bfbd01d01f1bc19aea2b155956dad07e64b425",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-07-18 05:32:51.000000000",
            "message": "Patch Set 2: Works for me\n\nSmokeStack Results (patch set 2):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/102100\n",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "2c1f1b68dc7e1a3c7e6c23a6ef586e36e81b7bfa",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-07-18 06:04:30.000000000",
            "message": "Patch Set 2: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/37421/2/check/gate-glance-pep8/5385 : SUCCESS in 1m 39s\n- http://docs-draft.openstack.org/37421/2/check/gate-glance-docs/3412/doc/build/html/ : SUCCESS in 1m 57s\n- http://logs.openstack.org/37421/2/check/gate-glance-python26/4824 : SUCCESS in 11m 02s\n- http://logs.openstack.org/37421/2/check/gate-glance-python27/4860 : SUCCESS in 9m 19s\n- http://logs.openstack.org/37421/2/check/gate-tempest-devstack-vm-full/33414 : SUCCESS in 48m 39s\n- http://logs.openstack.org/37421/2/check/gate-tempest-devstack-vm-cells-full/1166 : FAILURE in 13m 35s (non-voting)\n- http://logs.openstack.org/37421/2/check/gate-tempest-devstack-vm-testr-full/22 : SUCCESS in 26m 48s (non-voting)\n- http://logs.openstack.org/37421/2/check/gate-tempest-devstack-vm-postgres-full/33104 : SUCCESS in 47m 18s\n- http://logs.openstack.org/37421/2/check/gate-tempest-devstack-vm-neutron/5080 : FAILURE in 21m 26s (non-voting)\n- http://logs.openstack.org/37421/2/check/gate-grenade-devstack-vm/19203 : SUCCESS in 21m 56s (non-voting)\n",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "de94c80d897cdba9ca23ba645712f589e684f36c",
            "author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "real_author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "date": "2013-07-18 15:04:13.000000000",
            "message": "Patch Set 2: Looks good to me, but someone else must approve\n\n",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "f303485d7ac7eb3a38b80987bcd600e795857382",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-07-18 15:21:13.000000000",
            "message": "Patch Set 2: I would prefer that you didn't merge this\n\nHey,\n\nI think we can move that code to a common file as @paul suggested on IRC, perhaps a function called: exc_to_str ?\n\nThis will also help with the 2to3 migration.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "6b4f904f0af580136681373c986a2e4eb39b7626",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-25 08:02:22.000000000",
            "message": "Uploaded patch set 3.",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "5e7a7568679a79820c9278be061f51c8a4d1217c",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-25 08:07:10.000000000",
            "message": "Patch Set 2:\n\nHey flaper87: Agreed, I have added a new 'exception_to_str()' function to 'glance.common.utils', and IMO we can land it to glance firstly then move it to 'oslo.strutils' later after we make sure it good enough just like your 'safe_encode()'. Please review PS3.",
            "accounts_in_message": [],
            "_revision_number": 2
        },
        {
            "id": "c97d2a3a4c38c418a00c153dfcf1e68f0e7e60be",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-07-25 08:23:09.000000000",
            "message": "Patch Set 3: Works for me\n\nSmokeStack Results (patch set 3):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/104009\n",
            "accounts_in_message": [],
            "_revision_number": 3
        },
        {
            "id": "6810540fbb8ecb1adbe8d5f6e7f0843c2dda994f",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-25 08:48:31.000000000",
            "message": "Uploaded patch set 4.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "625602554b083fff28bb8b43a4a99b2859c03f43",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-07-25 09:11:31.000000000",
            "message": "Patch Set 4: Works for me\n\nSmokeStack Results (patch set 4):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/104030\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "084d897474fa89c3774800354df36396296d41d6",
            "author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "real_author": {
                "_account_id": 1390,
                "name": "Paul Bourke",
                "email": "pauldbourke@proton.me",
                "username": "pauldbourke"
            },
            "date": "2013-07-25 09:39:40.000000000",
            "message": "Patch Set 4: Looks good to me, but someone else must approve\n\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "da4d89e2758eece525e046ab49bbf3853cab5d47",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-07-25 09:47:48.000000000",
            "message": "Patch Set 4: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/21/37421/4/check/gate-glance-pep8/5523 : SUCCESS in 2m 16s\n- http://docs-draft.openstack.org/21/37421/4/check/gate-glance-docs/3550/doc/build/html/ : SUCCESS in 1m 50s\n- http://logs.openstack.org/21/37421/4/check/gate-glance-python26/4962 : SUCCESS in 14m 25s\n- http://logs.openstack.org/21/37421/4/check/gate-glance-python27/4998 : SUCCESS in 9m 26s\n- http://logs.openstack.org/21/37421/4/check/gate-tempest-devstack-vm-full/35415 : SUCCESS in 59m 12s\n- http://logs.openstack.org/21/37421/4/check/gate-tempest-devstack-vm-cells-full/2805 : FAILURE in 16m 25s (non-voting)\n- http://logs.openstack.org/21/37421/4/check/gate-tempest-devstack-vm-testr-full/1636 : FAILURE in 30m 09s (non-voting)\n- http://logs.openstack.org/21/37421/4/check/gate-tempest-devstack-vm-postgres-full/35103 : SUCCESS in 48m 23s\n- http://logs.openstack.org/21/37421/4/check/gate-tempest-devstack-vm-neutron/7376 : SUCCESS in 18m 32s (non-voting)\n- http://logs.openstack.org/21/37421/4/check/gate-grenade-devstack-vm/21020 : SUCCESS in 27m 08s\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "5682084e11971db3922dd5c5b202a0da6dad7282",
            "author": {
                "_account_id": 7823,
                "name": "Xiang Hui",
                "email": "xianghuir@gmail.com",
                "username": "xianghui"
            },
            "real_author": {
                "_account_id": 7823,
                "name": "Xiang Hui",
                "email": "xianghuir@gmail.com",
                "username": "xianghui"
            },
            "date": "2013-07-25 11:16:05.000000000",
            "message": "Patch Set 4: Looks good to me, but someone else must approve\n\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "01d1b49da21d4c6e2e1cf1a7fad3037514fb0495",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-07-25 12:47:53.000000000",
            "message": "Patch Set 4: Looks good to me (core reviewer)\n\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "1103ef2bce7e3b6f8d00357b6102d26312c1cb0c",
            "author": {
                "_account_id": 6484,
                "name": "Feilong Wang",
                "email": "hustemb@gmail.com",
                "username": "flwang"
            },
            "real_author": {
                "_account_id": 6484,
                "name": "Feilong Wang",
                "email": "hustemb@gmail.com",
                "username": "flwang"
            },
            "date": "2013-07-25 13:01:11.000000000",
            "message": "Patch Set 4: Looks good to me, but someone else must approve\n\nLGTM. A big improvement compared with the patch set 1.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "3b435b95e66dcd2ad5b00f69cf463bb8c3dff655",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-07-25 15:09:49.000000000",
            "message": "Patch Set 4: I would prefer that you didn't merge this\n\n(2 inline comments)\n\nThere's a small typo and question about a particular exception. Check the comments.\n\nexception_to_str() seems unnecessary.\n\nlogging.info() handles Unicode just fine. If it's failing somewhere, it has to be how Glance sets up logging.\n\nAlso, assuming UTF-8 will be used for all logging targets is a bad idea. All strings should be Unicode and let the target convert to the appropriate character set.\n\nNot to mention that this will make supporting Python 3 harder too.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "e73b950ee5b2e433abe1fad12eac39050b8d8df3",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-07-25 15:34:16.000000000",
            "message": "Patch Set 4: (1 inline comment)\n\n",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "620a6e6870cdaa2f98523b6affaa89467c23676b",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-25 22:14:04.000000000",
            "message": "Patch Set 4: (1 inline comment)\n\nHey Johannes Erdfelt\n\nI think exception_to_str() is necessary. the problem for this bug it not happened on logging.warn() calling, it failed on string join: line #44 in https://review.openstack.org/#/c/37421/4/glance/store/base.py .",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "eec8ffd8c3f2ad63743a42ffda110dbb232da162",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-07-25 22:57:21.000000000",
            "message": "Patch Set 4:\n\nIt looks like this is the problem you're having:\n\n    >>> e = Exception(u'\\u2022')\n    >>> 'test: %s' % e\n    Traceback (most recent call last):\n      File \"<stdin>\", line 1, in <module>\n    UnicodeEncodeError: 'ascii' codec can't encode character u'\\u2022' in position 0: ordinal not in range(128)\n\nThere's a couple of possible fixes:\n\n    >>> u'test: %s' % e\n    u'test: \\u2022'\n\nor\n\n    >>> 'test: %s' % unicode(e)\n    u'test: \\u2022'\n\nIn either case, we really want to keep all strings in a unicode type for as long as possible. The conversion to any other encoding (utf-8, windows-1252, etc) should happen at the edges (writing to screen, log file, etc). Especially since there might be multiple different encodings used at those edges.\n\nAlso, this ensures we use one normalized encoding (the Python unicode type) internally. Mixing different encodings will cause problems.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "27148ca0a277b15b34d8f15177f898990339d7c8",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-26 02:08:55.000000000",
            "message": "Patch Set 4:\n\nOverall I agreed, but if you check the details of bug 1202098 , you can see the inconsistent encoding string be raised at https://github.com/openstack/glance/blob/master/glance/store/sheepdog.py#L207 , and this point exactly is the edges for the store driver by the driver developer's perspective. So, I consider the 'exception_to_str()' function which perform maximum conversion is necessary on driver's direct wrapper layer. In Py3 the default encoding is unicode, py2 is ascii.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "d4830e404a19e5613c65f228310558ab26bd9b10",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-07-26 05:05:30.000000000",
            "message": "Patch Set 4:\n\nIt doesn't matter who or where raises an exception that has has unicode characters, the solution is the same.\n\nI'm confused why you changed your patch. It was correct to start with. Even your commit message is correct!",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "274b56b3b184a4888db96973df506baff576ccbe",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-07-26 10:02:06.000000000",
            "message": "Patch Set 4:\n\n@Johannes Erdfelt, take look this: https://review.openstack.org/#/c/37421/1/glance/store/base.py",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "8d070e9b2f268b838564c5f35dfbbd121bbbaedc",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-07-26 14:04:11.000000000",
            "message": "Patch Set 4:\n\nZhi, I have already looked at patch 1. (How else would I know it was correct?)\n\nFlavio is mistaken for all of the reasons I've given previously.\n\nYour current patch is more complicated than it needs to be and in fact introduces bugs.\n\nHere's a some good sources for why you should decode early (not relevant for this discussion) and why you should encode late:\nhttp://farmdev.com/talks/unicode/\nhttp://eric.themoritzfamily.com/python-encodings-and-unicode.html\n\nTake this as an example: Someone has configured their logging setup to use UTF-16 or UTF-32. What will your last patch do? What will your first patch do?\n\nUltimately, the encoding choice is not your decision! It's the users decision. Don't make it for them. This is why we want to do the encoding as late as possible, where the user can make that decision for themselves.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "4cacfa927136da56cdc634641a8b8d20fe25f372",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-08-02 09:51:54.000000000",
            "message": "Patch Set 4:\n\n@Johannes \n\nHey,\n\nThanks for your comments!\n\nI've a couple of questions:\n\nHow does this patch complicates things? \n\nFor us, the most important thing here is being able to log the actual error w/o hiding it behind other errors.\n\nWhat bugs does this patch introduce?\n\nIMHO, the patch is keeping everything decoded as long as possible. The encoding happens right before calling logging.\n\nPls, share your ideas about how to fix this if you still consider this approach is wrong. Unfortunately, calling unicode is not enough nor it is passing everything to the logging module.\n\nOne last comment:\n\nI'm not sure logging module can handle decode / encode just fine, see the example bellow:\n\n    >>> import logging\n    >>> FORMAT = \"%(asctime)-15s %(clientip)s %(user)-8s %(message)s\"\n    >>> logging.basicConfig(format=FORMAT)\n    >>> d = {'clientip': '192.168.0.1', 'user': Exception(u'ni\\xf1o')}\n    >>> logging.warning(\"Protocol problem: %s\", \"connection reset\", extra=d)\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 851, in emit\n        msg = self.format(record)\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 724, in format\n        return fmt.format(record)\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 467, in format\n        s = self._fmt % record.__dict__\n    UnicodeEncodeError: 'ascii' codec can't encode character u'\\xf1' in position 2: ordinal not in range(128)\n    Logged from file <stdin>, line 1\n    >>> logging.warning(u\"Protocol problem: %s\", \"connection reset\", extra=d)\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 851, in emit\n        msg = self.format(record)\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 724, in format\n        return fmt.format(record)\n      File \"/usr/lib64/python2.7/logging/__init__.py\", line 467, in format\n        s = self._fmt % record.__dict__\n    UnicodeEncodeError: 'ascii' codec can't encode character u'\\xf1' in position 2: ordinal not in range(128)\n    Logged from file <stdin>, line 1\n    >>> u'ni\\xf1o'\n    u'ni\\xf1o'\n    >>> print u'ni\\xf1o'\n    ni\u00f1o\n\nThanks again!",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "2a2116cd3a4153185c0c1efc4e7668d030273de5",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-08-02 14:52:37.000000000",
            "message": "Patch Set 4:\n\nPlease go back and read all of the previous comments. I've explained the potential problems and even proposed some thought experiments for you to think through.\n\nAs far as your example goes:\n\n1) It's nonsensical. Why is user an exception?\n2) It has nothing to do with what the patch is trying to fix\n3) It works fine if you make the format a unicode string too\n\n    >>> import logging\n    >>> FORMAT = u\"%(asctime)-15s %(clientip)s %(user)-8s %(message)s\"\n    >>> logging.basicConfig(format=FORMAT)\n    >>> d = {'clientip': '192.168.0.1', 'user': Exception(u'ni\\xf1o')}\n    >>> logging.warning(\"Protocol problem: %s\", \"connection reset\", extra=d)\n    2013-08-02 07:49:44,833 192.168.0.1 ni\u00f1o     Protocol problem: connection reset",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "b185482764e3c8113425f5fcdc69e193c3df045e",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-08-05 11:33:28.000000000",
            "message": "Patch Set 4:\n\nHey @Johannes\n\nThanks again for your reply.\n\nI did read your comments before posting, actually, my questions were based on those comments and the purpose was to summarize your concerns and try to address them either by changing the patch or clarifying possible doubts. If you're still interested, pls, answer those questions or attend to our next meeting and bring this patch up for discussion under the \"Open Discussion\" topic.\n\nRe: the example. I'm afraid you missed the whole point of it. I didn't expect you to interpret the message itself but to help me understand what you exactly meant with \"logging can handle unicode perfectly\", which I still think it doesn't. If you pass a unicode as message and then use a non-unicode string for the arguments, it'll fail anyway. This is why we need to make sure we pass encoded strings to logging and more importantly, this is why we take care of the whole encoding process ourselves. Pls, find bellow an example of what I just said. Also, it has everything to do with the patch since the whole point here is being able to log non-ascii characters that might be present in some exceptions.\n\nIn summary, as far as this patch goes, I still think it solves our issue and implements it in a way we can re-use the code for future cases.\n\nThanks for your thoughts.\n\n>>> import logging\n>>> FORMAT = u\"%(asctime)-15s %(clientip)s %(user)-8s %(message)s\"\n>>> logging.basicConfig(format=FORMAT)\n>>> d = {'clientip': '192.168.0.1', 'user': Exception(\"ni\\xc3\\xb1o\")}                                                                                                                                                                          \n>>> logging.warning(\"Protocol problem: %s\", \"connection reset\", extra=d)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/logging/__init__.py\", line 851, in emit\n    msg = self.format(record)\n  File \"/usr/lib/python2.7/logging/__init__.py\", line 724, in format\n    return fmt.format(record)\n  File \"/usr/lib/python2.7/logging/__init__.py\", line 467, in format\n    s = self._fmt % record.__dict__\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 2: ordinal not in range(128)\nLogged from file <stdin>, line 1\n>>>",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "c527791fd538c29c2b581db570609bc1f8d7a0e6",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-08-05 17:49:45.000000000",
            "message": "Patch Set 4:\n\nNow I'm not saying that the logging module is perfect, but it can handle unicode just fine. It does need a little bit of help in some cases (mostly because of Python 2).\n\nYour latest example shows exactly why you should be decoding strings early (you are using an encoded string in the exception).\n\nYou really want to keep \"strings\" internally in the unicode type if they can contain anything more than ASCII characters.\n\nThe reasons behind this are:\n1) You never know what the user will want the output to be. Assuming utf-8 will disappoint anyone who doesn't use utf-8. The only safe thing to do is keep the string in a \"normalized\" format and then encode as late as possible where the code that finally outputs the string *does* know what the user wants\n2) In python 3, str() is actually unicode() (for exactly the same reasons you should be using unicode() in python 2). Keeping everything in unicode() type is forward compatible with python 3, but encoding to utf-8 early isn't.\n\nSo why not use utf-8 as the normalized format internally? Because we already have the unicode() type that is specifically for this purpose plus it has a lot of extra functionality to makes code easier to write.\n\nHere's yet another article that explains a lot of the reasons why you should decode early and encode late (as well as common frustrations with unicode in Python 2):\n\nhttp://pythonhosted.org/kitchen/unicode-frustrations.html\n\nAnd if you're looking for a code example for my utf-16 thought experiment:\n\n    import codecs\n    import logging\n    class FileHandler(logging.StreamHandler):\n        def __init__(self, filename, encoding):\n            logging.StreamHandler.__init__(self)\n            self.file = codecs.open(filename, mode='a', encoding=encoding)\n        def emit(self, record):\n            msg = self.format(record)\n            print >>self.file, msg\n    logger = logging.getLogger('')\n    formatter = logging.Formatter(u'%(foo)s %(message)s')\n    #formatter = logging.Formatter('%(foo)s %(message)s')\n    terminal = logging.StreamHandler()\n    terminal.setFormatter(formatter)\n    logger.addHandler(terminal)\n    logfile = FileHandler('utf-16.log', 'utf-16')\n    logfile.setFormatter(formatter)\n    logger.addHandler(logfile)\n    logger.error('test', extra={'foo': u'\\u2022'})          # Succeeds\n    logger.error('test', extra={'foo': u'\\u2022'.encode('utf-8')})  # FAIL\n\nIn this example there are two handlers being written to for every log line. The first is a normal StreamHandler for sys.stderr which will encode to whatever your terminal is (usually utf-8).\n\nThe second is a simple handler to write to a utf-16 encoded log file.\n\nSo to summarize, not only is the original version of this patch smaller, it's also easier to use, doesn't make assumptions about what the user wants and is also forward compatible with Python 3.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "39fe8d4f8bafc2709e3c6ffce285b04bc8666ba7",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-08-06 18:59:47.000000000",
            "message": "Patch Set 4: I would prefer that you didn't merge this\n\nI finally think I understand the complex issues around this thread! Hooray!\n\nJohannes, thanks so much for your input. I feel like I've learned a good bit about a sensible encode/decode philosophy.\n\nI think one issue we run into when discussing this patch is that the degree to which the glance project \"owns\" the store drivers is somewhat confusing. I think we all agree that is best to convert the exception messages to unicode as early as possible--ideally you would never actually create an exception message that was not unicode. In this view, if we owned the store drivers 100%, we would just perform the unicode() cast directly in the store drivers before instantiating the Exception objects.\n\nHowever, if we do not completely own the drivers, it makes sense to view the first point of entry of the non-unicode string as when the exception is raised. If we hold that view, it makes sense to catch the exceptions and encode their messages in glance.store.base. Since that is my view, I am generally in favor of the patch.\n\nI believe another one of Johannes' concerns is that, as a result of not decoding/encoding at the correct times, we will end up sprinkling ugly conversion calls throughout the code. I see this approach as inappropriate, as I expect many of the conversion calls we add would be unnecessary, yet no amount of sprinkling would guarantee that we have caught all the bugs in the same class. In this sense, its clear that putting encoding and assertions at the boundaries of our code is the correct approach.\n\nFor that reason, I believe we should not make the conversion a utility function. Instead, it should be defined in glance.store.base not far from where it is used. We should not suggest that it be more widely used in other portions of the code.\n\nSo to summarize, I think we should keep the conversion step as it is in glance.store.base, but move the utility function to a private function in the same glance.store.base module.\n\nThanks to everyone for talking this one out. Again, I feel like I really learned something and am glad to see everyone engaged in figuring out the best approach.",
            "accounts_in_message": [],
            "_revision_number": 4
        },
        {
            "id": "138fff95a4d4619b510782e8981c0d8ad3f894df",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-08-07 05:44:23.000000000",
            "message": "Uploaded patch set 5.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "16ad0a6ba676caac37f3fc5f52aadad6dadf6e86",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-08-07 06:06:08.000000000",
            "message": "Patch Set 5: Works for me\n\nSmokeStack Results (patch set 5):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/110020\n\tLibvirt (Centos 6.4) Success: http://smokestack.openstack.org/?go=/jobs/110021\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "165ab49903045718f69662f12c3acde34a8b268a",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-07 06:30:22.000000000",
            "message": "Patch Set 5: Works for me\n\nBuild succeeded.\n\n- http://logs.openstack.org/21/37421/5/check/gate-glance-pep8/8d6c605 : SUCCESS in 2m 01s\n- http://docs-draft.openstack.org/21/37421/5/check/gate-glance-docs/903e15d/doc/build/html/ : SUCCESS in 2m 01s\n- http://logs.openstack.org/21/37421/5/check/gate-glance-python26/acb525f : SUCCESS in 10m 49s\n- http://logs.openstack.org/21/37421/5/check/gate-glance-python27/13a4f74 : SUCCESS in 13m 52s\n- http://logs.openstack.org/21/37421/5/check/gate-tempest-devstack-vm-full/66cd7dc : SUCCESS in 43m 09s\n- http://logs.openstack.org/21/37421/5/check/gate-tempest-devstack-vm-cells-full/9ea0884 : FAILURE in 12m 12s (non-voting)\n- http://logs.openstack.org/21/37421/5/check/gate-tempest-devstack-vm-testr-full/c8eff50 : FAILURE in 28m 50s (non-voting)\n- http://logs.openstack.org/21/37421/5/check/gate-tempest-devstack-vm-postgres-full/d761a21 : SUCCESS in 45m 50s\n- http://logs.openstack.org/21/37421/5/check/gate-tempest-devstack-vm-neutron/13a3881 : SUCCESS in 22m 44s\n- http://logs.openstack.org/21/37421/5/check/gate-grenade-devstack-vm/340e2f4 : SUCCESS in 26m 20s\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "bd945b0d8f0dd2e045a91f40c73621c66034bab2",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-08-07 16:11:32.000000000",
            "message": "Patch Set 5: Looks good to me (core reviewer)\n\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "3237ab2cbaf954411cd7a373bf29a65edfef6e75",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-08-07 17:02:00.000000000",
            "message": "Patch Set 5: I would prefer that you didn't merge this\n\nMark, I'm not sure you completely understand the problem here since you are making this to be a more complex problem than it really is.\n\nCalling .encode() on a unicode type should *only* be done at the latest possible time (ie right before it *needs* to be a specific encoding).\n\nIn this case, it should be done by whatever logging handlers have been configured. This is because there may be multiple logging handlers and each one may want to use a different encoding. You *should not* define policy (like strutils.safe_encode() does implicitly by using utf-8 encoding). Letting the logging handlers do the encoding is the most sensible behavior.\n\nExceptions should *only* be converted to unicode type using the unicode() constructor. str() should *never* be used on an exception since the exception may contain more than ASCII characters.\n\nAs a result, _exception_to_str() is unnecessary. Since exceptions should *always* be converted using unicode(), there is no reason to ever call str() on an exception.\n\nAlso, since unicode() types should *never* be encoded early, it should *not* be done before calling logging.warn().\n\nAnything that encodes a unicode type early is a bug.\n\nAgain, patch #1 is the correct way to fix this bug. It's also simpler and idiomatic.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "6b05c04b95f09e228591c6e46a30e5c429dd03b9",
            "author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "real_author": {
                "_account_id": 6159,
                "name": "Flavio Percoco",
                "display_name": "flaper87",
                "email": "fpercoco@redhat.com",
                "username": "flaper87"
            },
            "date": "2013-08-08 07:48:01.000000000",
            "message": "Patch Set 5: Looks good to me (core reviewer); Approved\n\nTBH, I think we're all agreeing on the same think, the only bit that we're not agreeing on is the timing for this whole standard to land in Glance.\n\nGlance does not handle unicode / str conversion correctly, yet. I've created a bug #1210031 for that with the hope we'll be able to close this issue once and for all.\n\nThanks for your thoughts.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "63b374c88ee0996ee1074600ea928a126269647e",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-08 07:48:03.000000000",
            "message": "Patch Set 5: No score\n\nStarting gate jobs.\nhttp://status.openstack.org/zuul/",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "a907b243c2b6e6c5d363b1510c794a14f60551d9",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-08 08:31:40.000000000",
            "message": "Patch Set 5: Fails\n\nBuild failed.  For information on how to proceed, see https://wiki.openstack.org/wiki/GerritJenkinsGithub#Test_Failures\n\n- http://docs-draft.openstack.org/21/37421/5/gate/gate-glance-docs/6e838bd/doc/build/html/ : SUCCESS in 3m 21s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-pep8/b2e9b51 : SUCCESS in 2m 51s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-python26/83fded4 : SUCCESS in 11m 39s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-python27/e1d94db : SUCCESS in 8m 39s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-full/45a9619 : SUCCESS in 40m 30s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-postgres-full/b3a7382 : SUCCESS in 43m 24s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-neutron/5302755 : SUCCESS in 17m 40s\n- http://logs.openstack.org/21/37421/5/gate/gate-grenade-devstack-vm/9916ad0 : FAILURE in 16m 47s\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "6c8da5c5da3fefd7dc80e515baeed20ce98ede3a",
            "author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "real_author": {
                "_account_id": 6549,
                "name": "Zhi Yan Liu",
                "email": "lzy.dev@gmail.com",
                "username": "lzy-dev"
            },
            "date": "2013-08-08 08:34:56.000000000",
            "message": "Patch Set 5:\n\nreverify no bug",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "997eb8f8fcacf62ade9399f47a546f6cf0ccbbb1",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-08 08:34:58.000000000",
            "message": "Patch Set 5: No score\n\nStarting gate jobs.\nhttp://status.openstack.org/zuul/",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "00e7a057e68000e49a3aeeecaaf2c16b1e6aea85",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-08 09:24:03.000000000",
            "message": "Patch Set 5: Verified\n\nBuild succeeded.\n\n- http://docs-draft.openstack.org/21/37421/5/gate/gate-glance-docs/578707e/doc/build/html/ : SUCCESS in 5m 09s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-pep8/bd2b9ec : SUCCESS in 4m 01s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-python26/d50c65b : SUCCESS in 12m 07s\n- http://logs.openstack.org/21/37421/5/gate/gate-glance-python27/6c62e01 : SUCCESS in 10m 37s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-full/15b85e4 : SUCCESS in 44m 14s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-postgres-full/bf5b91b : SUCCESS in 49m 00s\n- http://logs.openstack.org/21/37421/5/gate/gate-tempest-devstack-vm-neutron/35e051e : SUCCESS in 19m 26s\n- http://logs.openstack.org/21/37421/5/gate/gate-grenade-devstack-vm/89d18c4 : SUCCESS in 27m 06s\n",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "d5779597f4153804e43b4036680f02f67a6ac14d",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-08-08 09:24:03.000000000",
            "message": "Change has been successfully merged into the git repository.",
            "accounts_in_message": [],
            "_revision_number": 5
        },
        {
            "id": "9b02d849c8940aa5a5c47b381fc91f6ce59fbb34",
            "author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "real_author": {
                "_account_id": 100,
                "name": "Johannes Erdfelt",
                "email": "johannes@erdfelt.com",
                "username": "johannes.erdfelt"
            },
            "date": "2013-08-08 16:17:35.000000000",
            "message": "Patch Set 5:\n\nI have no idea how after my last message you managed to take away \"we're all agreeing on the same thing\".\n\nThis patch is a step backwards and makes things worse.\n\nI'm disappointed that this patch has been merged after my earnest attempt to explain why it's a bad idea.",
            "accounts_in_message": [],
            "_revision_number": 5
        }
    ],
    "requirements": [],
    "submit_records": []
}
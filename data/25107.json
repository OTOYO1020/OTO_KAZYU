{
    "id": "openstack%2Fglance~master~Ie873584db812d4b3149ed3504f8bf29da56c8f38",
    "project": "openstack/glance",
    "branch": "master",
    "topic": "bug/1158247",
    "hashtags": [],
    "change_id": "Ie873584db812d4b3149ed3504f8bf29da56c8f38",
    "subject": "Revert \"A test for concurrency when glance uses sleep.\"",
    "status": "ABANDONED",
    "created": "2013-03-22 04:28:37.000000000",
    "updated": "2013-03-25 18:19:48.000000000",
    "insertions": 0,
    "deletions": 106,
    "total_comment_count": 0,
    "unresolved_comment_count": 0,
    "has_review_started": true,
    "meta_rev_id": "148324d2d410235e0130e3ef5cb014b55ffc937f",
    "_number": 25107,
    "owner": {
        "_account_id": 616,
        "name": "Mark Washenberger",
        "email": "mark.washenberger@markwash.net",
        "username": "markwash"
    },
    "labels": {
        "Verified": {
            "recommended": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "disliked": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "all": [
                {
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "_account_id": 24,
                    "name": "Chuck Short",
                    "email": "charles.short@windriver.com",
                    "username": "zulcss"
                },
                {
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 1,
                    "date": "2013-03-22 04:45:08.000000000",
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": -1,
                    "date": "2013-03-22 05:08:08.000000000",
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Fails",
                "-1": "Doesn't seem to work",
                " 0": "No score",
                "+1": "Works for me",
                "+2": "Verified"
            },
            "description": "",
            "value": -1,
            "default_value": 0,
            "optional": true
        },
        "Code-Review": {
            "disliked": {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            "all": [
                {
                    "value": 1,
                    "date": "2013-03-22 21:34:03.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "value": -1,
                    "date": "2013-03-22 15:57:12.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 24,
                    "name": "Chuck Short",
                    "email": "charles.short@windriver.com",
                    "username": "zulcss"
                },
                {
                    "value": 0,
                    "date": "2013-03-22 04:35:29.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "value": 0,
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 1
                    },
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-2": "Do not merge",
                "-1": "This patch needs further work before it can be merged",
                " 0": "No score",
                "+1": "Looks good to me, but someone else must approve",
                "+2": "Looks good to me (core reviewer)"
            },
            "description": "",
            "value": -1,
            "default_value": 0,
            "optional": true
        },
        "Workflow": {
            "all": [
                {
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "_account_id": 24,
                    "name": "Chuck Short",
                    "email": "charles.short@windriver.com",
                    "username": "zulcss"
                },
                {
                    "value": 0,
                    "date": "2013-03-22 04:35:29.000000000",
                    "permitted_voting_range": {
                        "min": -1,
                        "max": 0
                    },
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Work in progress",
                " 0": "Ready for reviews",
                "+1": "Approved"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        },
        "Review-Priority": {
            "all": [
                {
                    "_account_id": 6493,
                    "name": "John Bresnahan",
                    "email": "john@bresnahan.me",
                    "username": "jbresnah"
                },
                {
                    "_account_id": 24,
                    "name": "Chuck Short",
                    "email": "charles.short@windriver.com",
                    "username": "zulcss"
                },
                {
                    "_account_id": 616,
                    "name": "Mark Washenberger",
                    "email": "mark.washenberger@markwash.net",
                    "username": "markwash"
                },
                {
                    "_account_id": 2166,
                    "name": "SmokeStack CI",
                    "username": "smokestack",
                    "tags": [
                        "SERVICE_USER"
                    ]
                },
                {
                    "_account_id": 3,
                    "name": "Jenkins",
                    "username": "jenkins"
                }
            ],
            "values": {
                "-1": "Branch Freeze",
                " 0": "No Priority",
                "+1": "Important Change",
                "+2": "Top Priority / Holds Gate"
            },
            "description": "",
            "default_value": 0,
            "optional": true
        }
    },
    "removable_reviewers": [],
    "reviewers": {
        "REVIEWER": [
            {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            }
        ]
    },
    "pending_reviewers": {},
    "reviewer_updates": [
        {
            "updated": "2013-03-22 04:45:08.000000000",
            "updated_by": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "reviewer": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-03-22 05:08:08.000000000",
            "updated_by": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "reviewer": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-03-22 15:57:12.000000000",
            "updated_by": {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            "reviewer": {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            "state": "REVIEWER"
        },
        {
            "updated": "2013-03-22 21:34:03.000000000",
            "updated_by": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "reviewer": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "state": "REVIEWER"
        }
    ],
    "messages": [
        {
            "id": "46174a505997ab1c0d6acb1922375aaa68557138",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-03-22 04:35:29.000000000",
            "message": "Patch Set 1:\n\nSince its a bit nasty of me to remove this after it just landed, I wanted to provide my rational.\n\n1) This test was causing some problems in the bug listed in the commit message. There may be other ways around that problem as Chuck proposed, but removing it is cleaner.\n2) This test is slow, taking at least 2 seconds per run. Yes, 2 seconds is slow--maybe not slower than a bunch of other tests we have, but that just means we've got a lot of tests to fix.\n3) This test is ultimately testing whether or not eventlet monkey patching works, not just whether it is called with the right argument. Generally speaking, we shouldn't spend time testing external libraries.\n4) Tracking concurrency and performance is best left to benchmarking suites, not test suites.\n\nHopefully one or more of these items has some appeal to other folks.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "1842ea540a6889b1acfd9a04e6941203c0b96d26",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-03-22 04:36:47.000000000",
            "message": "Patch Set 1:\n\nOkay, gerrit formatting made that hard to read. Let's try it again.\n\nEarlier I said:\n\nSince its a bit nasty of me to remove this after it just landed, I wanted to provide my rationale.\n\n1) This test was causing some problems in the bug listed in the commit message. There may be other ways around that problem as Chuck proposed, but removing it is cleaner.\n\n2) This test is slow, taking at least 2 seconds per run. Yes, 2 seconds is slow--maybe not slower than a bunch of other tests we have, but that just means we've got a lot of tests to fix.\n\n3) This test is ultimately testing whether or not eventlet monkey patching works, not just whether it is called with the right argument. Generally speaking, we shouldn't spend time testing external libraries. \n\n4) Tracking concurrency and performance is best left to benchmarking suites, not test suites.\n\nHopefully one or more of these items has some appeal to other folks.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "d1a0cb7e6ae9bdb834ced88ee33064dd533aba31",
            "author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "real_author": {
                "_account_id": 2166,
                "name": "SmokeStack CI",
                "username": "smokestack",
                "tags": [
                    "SERVICE_USER"
                ]
            },
            "date": "2013-03-22 04:45:08.000000000",
            "message": "Patch Set 1: Works for me\n\nSmokeStack Results (patch set 1):\n\tLibvirt (Fedora 18) Success: http://smokestack.openstack.org/?go=/jobs/79381\n\tXenServer 5.6 (F18 domU) Success: http://smokestack.openstack.org/?go=/jobs/79382\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "daa9ccff56b613f359b08d25dc8978f24c05b5fb",
            "author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "real_author": {
                "_account_id": 3,
                "name": "Jenkins",
                "username": "jenkins"
            },
            "date": "2013-03-22 05:08:08.000000000",
            "message": "Patch Set 1: Doesn't seem to work\n\nBuild failed.  For information on how to proceed, see https://wiki.openstack.org/wiki/GerritJenkinsGithub#Test_Failures\n\n- http://logs.openstack.org/25107/1/check/gate-glance-pep8/4244 : SUCCESS\n- http://logs.openstack.org/25107/1/check/gate-glance-docs/2279 : SUCCESS\n- http://logs.openstack.org/25107/1/check/gate-glance-python26/3699 : FAILURE\n- http://logs.openstack.org/25107/1/check/gate-glance-python26-rhel6/11 : FAILURE (non-voting)\n- http://logs.openstack.org/25107/1/check/gate-glance-python27/3729 : SUCCESS\n- http://logs.openstack.org/25107/1/check/gate-tempest-devstack-vm-full/9999 : SUCCESS\n- http://logs.openstack.org/25107/1/check/gate-tempest-devstack-vm-postgres-full/9714 : SUCCESS\n- http://logs.openstack.org/25107/1/check/gate-tempest-devstack-vm-quantum/15471 : SUCCESS\n",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "4ff5392e7147418b0bb7e0e1e3cdac8f2829874c",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2013-03-22 08:37:53.000000000",
            "message": "Patch Set 1: Looks good to me, but someone else must approve\n\nThere is nothing nasty about fixing problems.  Here is my take (in reverse order)\n\nWRT #4, I agree.\n\nWRT #3, I do not agree.  This tests whether or not we are monkey patching an imported module, not if the underlying library effectively does the monkey patching.  The latter is assumed.  This test was proposed after it was noticed in \nhttps://bugs.launchpad.net/glance/+bug/988099 that the time module was not being monkey patched, not whether or not the underlying library was doing so in an effective or efficient manner. The test was made to ensure that future changes did not undo the fix to that bug.\n\nWRT #2, In this case I agree.  But it could be a bad precedent.  The value of test should not be measured in the time it takes.  Possibly in a value/time ratio but I would rather see options to the test suite which skip long running tests (at a granularity that the user can set) instead of removing them due to their length.\n\nWRT #1, If it causes problems it needs to go.  This is definitely low risk, so if it is causing more time than it has the potential to save (and it seems that it is) than lets get rid of it.  This probably goes without saying because I am sure that we all agree it is better to figure out why a test is causing problems than it is to delete tests that do so.  It appears that this was done here.",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "2afa991e8006b887ae72d69039228a93c1ca1da6",
            "author": {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            "real_author": {
                "_account_id": 24,
                "name": "Chuck Short",
                "email": "charles.short@windriver.com",
                "username": "zulcss"
            },
            "date": "2013-03-22 15:57:12.000000000",
            "message": "Patch Set 1: I would prefer that you didn't merge this\n\nI have a work around for this:\n\nhttps://review.openstack.org/#/c/24997/",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "57bebb0504a62bd7c51b15e69b694b0e7035ff72",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-03-22 17:26:17.000000000",
            "message": "Patch Set 1:\n\nJohn,\n\nDo you suppose there is a way we could test this a little more directly, perhaps by cheating a little? Something like this pseudocode:\n\n\n  def test_monkey_patch(self):\n      import some.particular.module\n      self.assertTrue(patcher.time_is_patched())",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "8d82889a4fffaee57ac4f9f3cc28855e5628b28d",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2013-03-22 20:52:35.000000000",
            "message": "Patch Set 1: No score\n\nYes actually it seems that there is a surprising easy way to test this:\n\neventlet.patcher.is_monkey_patched(time)\n\nHow about it I alter the test to simply iterate through a few of those?",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "78280d95838ba69263f00e7561207a49bde93ff0",
            "author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "real_author": {
                "_account_id": 6493,
                "name": "John Bresnahan",
                "email": "john@bresnahan.me",
                "username": "jbresnah"
            },
            "date": "2013-03-22 21:34:03.000000000",
            "message": "Patch Set 1: Looks good to me, but someone else must approve\n\nI think that Chuck's patch is good and works.  However it is probably best to test this functionality in the way that Mark suggested and avoid the 2 second hit.  I submitted a new test for review here:\n\nhttps://review.openstack.org/25188",
            "accounts_in_message": [],
            "_revision_number": 1
        },
        {
            "id": "e89897f52b63b215b7636dbb8d148d1f94696a18",
            "author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "real_author": {
                "_account_id": 616,
                "name": "Mark Washenberger",
                "email": "mark.washenberger@markwash.net",
                "username": "markwash"
            },
            "date": "2013-03-25 18:19:48.000000000",
            "message": "Patch Set 1: Abandoned\n\nJohn has a change proposed to fix this test here:\n\nhttps://review.openstack.org/#/c/25188/",
            "accounts_in_message": [],
            "_revision_number": 1
        }
    ],
    "requirements": [],
    "submit_records": []
}